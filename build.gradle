/*
 * This build file was auto generated by running the Gradle 'init' task
 * by 'Administrator' at '7/21/15 12:31 PM' with Gradle 2.5
 *
 * This generated file contains a sample Java project to get you started.
 * For more details take a look at the Java Quickstart chapter in the Gradle
 * user guide available at http://gradle.org/docs/2.5/userguide/tutorial_java_projects.html
 */


apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'maven'

repositories {        

    maven {
         credentials {
             username = 'admin'
             password = 'admin123'
         }
           url "http://localhost:8088/nexus/content/groups/public"
      }
     jcenter()
}

configurations {
    deployerJars
    libraries
}

subprojects {
    apply plugin: 'java'
   
    test {
        reports.html.enabled = false
    }
}

task testReport(type: TestReport) {
    destinationDir = file("$buildDir/reports/allTests")
    
    // Include the results from the `test` task in all subprojects
    reportOn subprojects*.test
}



dependencies {
 
   runtime group: 'org.springframework', name: 'spring-core', version: '2.5'	
   compile 'junit:junit:4.4'
   
   libraries 'org.springframework:spring-core:2.5'	
   libraries 'junit:junit:4.4'
   
   configurations.compile.extendsFrom(configurations.libraries)
}

jar{
	into('/'){
		from configurations.libraries
	}
	from{
		configurations.compile.collect{
			it.isDirectory() ? it : zipTree(it)
		}
		configurations.runtime.collect{
			it.isDirectory() ? it : zipTree(it)
		}
	}

	manifest{
		attributes("Manifest-Version":"1.0",
		"Created-By" : "1.7.0_79 (Oracle Corporation)",
		"Main-Class":"br.com.primeup.example.dominio.Execucao",
		"Class-Path": configurations.compile.collect {it.getName()}.join(' '))
	}
}


task listJars {
	configurations.libraries.each { File file -> println file.name }
}

uploadArchives {
    repositories.mavenDeployer {
        configuration = configurations.deployerJars
        repository(url: "http://localhost:8088/nexus/content/repositories/releases-br") {
            authentication(userName: "admin", password: "admin123")
        }
        pom.version = '1.1'
        pom.groupId = 'br.org'
        pom.artifactId = 'exampleproject'
        
        
    }
}